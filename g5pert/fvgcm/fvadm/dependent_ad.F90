#ifdef    SPMD
!                           DISCLAIMER
!
!   This file was generated by TAF version 1.6.1
!
!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,
!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF
!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH
!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT
!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-
!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR
!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED
!   OF THE POSSIBILITY OF SUCH DAMAGES.
!
!                           Haftungsbeschraenkung
!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,
!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten
!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer
!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und
!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen
!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen
!   Mitteilung darueber an FastOpt.
!
module     dependent_ad
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.6.1   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use dependent

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

contains
subroutine model2dependent_ad( m, y_ad, prog_ad )
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.6.1   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use precision
use prognostics
use control, only : ibeg_u,iend_u
use control, only : ibeg_v,iend_v
use control, only : ibeg_delp,iend_delp
use control, only : ibeg_pt,iend_pt
use control, only : ibeg_q,iend_q
use control, only : ibeg_tr, iend_tr
use stepon, only : ng_d,ng_s
use mod_comm, only : mp_gather4d, mp_gather4d_ad

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

!==============================================
! declare arguments
!==============================================
integer :: m,m_nc
real(kind=r8) :: y_ad(m)
type(dyn_prog) :: prog_ad

!----------------------------------------------
! ROUTINE BODY
!----------------------------------------------
if (nc .gt. 1) then
    do m_nc=nc,2,-1
       call mp_gather4d_ad( prog_ad%q(:,:,:,m_nc),y_ad(ibeg_tr(m_nc-1)),imr,jnp,nl,1,jfirst,jlast,kfirst,klast,ng_d,ng_d,0 )
    enddo
endif

call mp_gather4d_ad( prog_ad%delp,y_ad(ibeg_delp),imr,jnp,nl,1,jfirst,jlast,kfirst,klast,0,0,0 )
call mp_gather4d_ad( prog_ad%q(:,:,:,1),y_ad(ibeg_q),imr,jnp,nl,1,jfirst,jlast,kfirst,klast,ng_d,ng_d,0 )
call mp_gather4d_ad( prog_ad%pt,y_ad(ibeg_pt),imr,jnp,nl,1,jfirst,jlast,kfirst,klast,ng_d,ng_d,0 )
call mp_gather4d_ad( prog_ad%v,y_ad(ibeg_v),imr,jnp,nl,1,jfirst,jlast,kfirst,klast,ng_s,ng_d,0 )
call mp_gather4d_ad( prog_ad%u,y_ad(ibeg_u),imr,jnp,nl,1,jfirst,jlast,kfirst,klast,ng_d,ng_s,0 )

end subroutine model2dependent_ad


end module     dependent_ad


#else  /* SPMD */
!                           DISCLAIMER
!
!   This file was generated by TAF version 1.6.1
!
!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,
!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF
!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH
!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT
!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-
!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR
!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED
!   OF THE POSSIBILITY OF SUCH DAMAGES.
!
!                           Haftungsbeschraenkung
!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,
!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten
!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer
!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und
!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen
!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen
!   Mitteilung darueber an FastOpt.
!
module     dependent_ad
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.6.1   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use dependent

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

contains
subroutine model2dependent_ad( m, y_ad, prog_ad )
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.6.1   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use precision
use prognostics
use control, only : ibeg_u,iend_u
use control, only : ibeg_v,iend_v
use control, only : ibeg_delp,iend_delp
use control, only : ibeg_pt,iend_pt
use control, only : ibeg_q,iend_q

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

!==============================================
! declare arguments
!==============================================
integer :: m
real(kind=r8) :: y_ad(m)
type(dyn_prog) :: prog_ad

!----------------------------------------------
! ROUTINE BODY
!----------------------------------------------
prog_ad%u(:,jfirst:jlast,:) = prog_ad%u(:,jfirst:jlast,:)+reshape(y_ad(ibeg_u:iend_u),(/size(u,1),1+jlast-jfirst,size(u,3)/))
y_ad(ibeg_u:iend_u) = 0.
prog_ad%v(:,jfirst:jlast,:) = prog_ad%v(:,jfirst:jlast,:)+reshape(y_ad(ibeg_v:iend_v),(/size(v,1),1+jlast-jfirst,size(v,3)/))
y_ad(ibeg_v:iend_v) = 0.
prog_ad%pt(:,jfirst:jlast,:) = prog_ad%pt(:,jfirst:jlast,:)+reshape(y_ad(ibeg_pt:iend_pt),(/size(pt,1),1+jlast-jfirst,size(pt,3)/))
y_ad(ibeg_pt:iend_pt) = 0.
prog_ad%q_(:,jfirst:jlast,:,1) = prog_ad%q(:,jfirst:jlast,:,1)+reshape(y_ad(ibeg_q:iend_q),(/size(q,1),1+jlast-jfirst,size(q,3)/))
y_ad(ibeg_q:iend_q) = 0.
prog_ad%delp(:,jfirst:jlast,:) = prog_ad%delp(:,jfirst:jlast,:)+reshape(y_ad(ibeg_delp:iend_delp),(/size(delp,1),1+jlast-jfirst,size(delp,3)/&
&))
y_ad(ibeg_delp:iend_delp) = 0.

end subroutine model2dependent_ad


end module     dependent_ad


#endif /* SPMD */
