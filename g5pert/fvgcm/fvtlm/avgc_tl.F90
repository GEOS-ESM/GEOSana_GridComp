#ifdef    SPMD
!                           DISCLAIMER
!
!   This file was generated by TAF version 1.6.1
!
!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,
!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF
!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH
!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT
!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-
!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR
!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED
!   OF THE POSSIBILITY OF SUCH DAMAGES.
!
!                           Haftungsbeschraenkung
!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,
!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten
!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer
!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und
!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen
!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen
!   Mitteilung darueber an FastOpt.
!
subroutine avgc_tl( aa, aa_tl, ac, ac_tl, im, jm, jfirst, jlast, wk, wk_tl )
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.6.1   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use precision

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

!==============================================
! declare arguments
!==============================================
integer :: im
integer :: jfirst
integer :: jlast
real(kind=r8) :: aa(im,jfirst-1:jlast+1)
real(kind=r8) :: aa_tl(im,jfirst-1:jlast+1)
real(kind=r8), intent(out) :: ac(im,jfirst:jlast+1)
real(kind=r8), intent(out) :: ac_tl(im,jfirst:jlast+1)
integer :: jm
real(kind=r8) :: wk(im,jfirst-1:jlast+1)
real(kind=r8) :: wk_tl(im,jfirst-1:jlast+1)

!==============================================
! declare local variables
!==============================================
integer :: i
integer :: j
integer :: jn1g1
integer :: js1g1
integer :: js2g0

!----------------------------------------------
! TANGENT LINEAR AND FUNCTION STATEMENTS
!----------------------------------------------
js1g1 = max(jfirst-1,1)
js2g0 = max(jfirst,2)
jn1g1 = min(jlast+1,jm)
do j = js1g1, jn1g1
  wk_tl(1,j) = aa_tl(im,j)+aa_tl(1,j)
  wk(1,j) = aa(1,j)+aa(im,j)
  do i = 2, im
    wk_tl(i,j) = aa_tl(i-1,j)+aa_tl(i,j)
    wk(i,j) = aa(i,j)+aa(i-1,j)
  end do
end do
do j = js2g0, jn1g1
  do i = 1, im
    ac_tl(i,j) = wk_tl(i,j-1)+wk_tl(i,j)
    ac(i,j) = wk(i,j)+wk(i,j-1)
  end do
end do

end subroutine avgc_tl


#else  /* SPMD */
!                           DISCLAIMER
!
!   This file was generated by TAF version 1.6.1
!
!   FASTOPT DISCLAIMS  ALL  WARRANTIES,  EXPRESS  OR  IMPLIED,
!   INCLUDING (WITHOUT LIMITATION) ALL IMPLIED  WARRANTIES  OF
!   MERCHANTABILITY  OR FITNESS FOR A PARTICULAR PURPOSE, WITH
!   RESPECT TO THE SOFTWARE AND USER PROGRAMS.   IN  NO  EVENT
!   SHALL  FASTOPT BE LIABLE FOR ANY LOST OR ANTICIPATED PROF-
!   ITS, OR ANY INDIRECT, INCIDENTAL, EXEMPLARY,  SPECIAL,  OR
!   CONSEQUENTIAL  DAMAGES, WHETHER OR NOT FASTOPT WAS ADVISED
!   OF THE POSSIBILITY OF SUCH DAMAGES.
!
!                           Haftungsbeschraenkung
!   FastOpt gibt ausdruecklich keine Gewaehr, explizit oder indirekt,
!   bezueglich der Brauchbarkeit  der Software  fuer einen bestimmten
!   Zweck.   Unter  keinen  Umstaenden   ist  FastOpt   haftbar  fuer
!   irgendeinen Verlust oder nicht eintretenden erwarteten Gewinn und
!   allen indirekten,  zufaelligen,  exemplarischen  oder  speziellen
!   Schaeden  oder  Folgeschaeden  unabhaengig  von einer eventuellen
!   Mitteilung darueber an FastOpt.
!
subroutine avgc_tl( aa, aa_tl, ac, ac_tl, im, jm, jfirst, jlast, wk, wk_tl )
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.6.1   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use precision

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

!==============================================
! declare arguments
!==============================================
integer :: im
integer :: jfirst
integer :: jlast
real(kind=r8) :: aa(im,jfirst-1:jlast+1)
real(kind=r8) :: aa_tl(im,jfirst-1:jlast+1)
real(kind=r8), intent(out) :: ac(im,jfirst:jlast+1)
real(kind=r8), intent(out) :: ac_tl(im,jfirst:jlast+1)
integer :: jm
real(kind=r8) :: wk(im,jfirst-1:jlast+1)
real(kind=r8) :: wk_tl(im,jfirst-1:jlast+1)

!==============================================
! declare local variables
!==============================================
integer :: i
integer :: j
integer :: jn1g1
integer :: js1g1
integer :: js2g0

!----------------------------------------------
! TANGENT LINEAR AND FUNCTION STATEMENTS
!----------------------------------------------
js1g1 = max(jfirst-1,1)
js2g0 = max(jfirst,2)
jn1g1 = min(jlast+1,jm)
do j = js1g1, jn1g1
  wk_tl(1,j) = aa_tl(im,j)+aa_tl(1,j)
  wk(1,j) = aa(1,j)+aa(im,j)
  do i = 2, im
    wk_tl(i,j) = aa_tl(i-1,j)+aa_tl(i,j)
    wk(i,j) = aa(i,j)+aa(i-1,j)
  end do
end do
do j = js2g0, jn1g1
  do i = 1, im
    ac_tl(i,j) = wk_tl(i,j-1)+wk_tl(i,j)
    ac(i,j) = wk(i,j)+wk(i,j-1)
  end do
end do

end subroutine avgc_tl


#endif /* SPMD */
