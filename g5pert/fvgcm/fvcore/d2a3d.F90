subroutine d2a3d ( u_tm, v_tm,  ua_tl,  va_tl, im, jm, km, jfirst, jlast, ng_d, ng_s, coslon, sinlon )
!******************************************************************
!******************************************************************
!** This routine was generated by Automatic differentiation.     **
!** FastOpt: Transformation of Algorithm in Fortran, TAF 1.5.2   **
!******************************************************************
!******************************************************************
!==============================================
! referencing used modules
!==============================================
use precision
use mod_comm, only : mp_barrier, mp_send_s, mp_recv_n

!==============================================
! all entries are defined explicitly
!==============================================
implicit none

!==============================================
! declare arguments
!==============================================
integer :: im
real(kind=r8) :: coslon(im)
integer :: jfirst
integer :: jlast
integer :: jm
integer :: km
integer :: ng_d
integer :: ng_s
real(kind=r8) :: sinlon(im)
!real(kind=r8) :: u_tm(im,jfirst-ng_d:jlast+ng_s,km)
real(kind=r8) :: u_tm(im,jfirst:jlast+1,km)
real(kind=r8) :: ua_tl(im,jfirst:jlast,km)
real(kind=r8) :: v_tm(im,jfirst-ng_s:jlast+ng_d,km)
real(kind=r8) :: va_tl(im,jfirst:jlast,km)

!==============================================
! declare local variables
!==============================================
integer :: k

!----------------------------------------------
! TANGENT LINEAR AND FUNCTION STATEMENTS
!----------------------------------------------

#ifdef SPMD
call mp_barrier
call mp_send_s(im,jm,jfirst,jlast,1,km,0,1,u_tm)
call mp_barrier
call mp_recv_n(im,jm,jfirst,jlast,1,km,0,1,u_tm)
#endif  

#ifdef USE_OPENMP
!$omp parallel do private(k)
#endif /* not USE_OPENMP */
do k = 1, km
  call d2a2( u_tm(1:im,jfirst:jlast+1,k),v_tm(1,jfirst,k), &
    ua_tl(1,jfirst,k),va_tl(1,jfirst,k),im,jm,jfirst,jlast,ng_d,ng_s, &
    coslon,sinlon)
end do

end subroutine d2a3d

